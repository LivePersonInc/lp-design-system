import { Meta, Story, Canvas, ArgsTable, SourceState } from '@storybook/addon-docs';

import { getPropsByDefaultProps } from '../../common/helpers';
import { commonArgTypes } from '../../common/storybook';

import Controlled from './Controlled';
import Checkbox from './Checkbox';
import './';

<Meta
  title="Components/Inputs/Checkbox"
  component={Checkbox}
  args={Checkbox.defaultProps}
  argTypes={{
    ...commonArgTypes,
    label: {},
    labelPosition: {
      control: { type: 'inline-radio' },
    },
    error: {},
    checked: {
      control: { type: 'boolean' },
    },
  }}
  parameters={{
    actions: {
      handles: ['change'],
    },
  }}
/>

export const Template = props => <lp-checkbox {...getPropsByDefaultProps(Checkbox.defaultProps, props)} />;

# Checkbox

<ArgsTable of={Checkbox} />

**Note:** Those attributes extend [HTMLInputElement](https://www.w3schools.com/tags/tag_input.asp) attributes

## Basic

<Canvas>
  <Story name="Basic">
    {Template.bind({})}
  </Story>
</Canvas>

## Controlled

<Canvas withSource={SourceState.NONE}>
  <Story
    name="Controlled"
    args={{ label: 'Checked', checked: true }}
    parameters={{
      controls: { disable: true },
      actions: { disable: true },
    }}
  >
    {Controlled.bind({})}
  </Story>
</Canvas>

```jsx
import React, { useCallback, useLayoutEffect, useRef, useState } from 'react';

import 'liveperson-design-system/components/checkbox';

const Checkbox = ({ ...props }) => {
  const checkboxRef = useRef(null);

  const [checked, setChecked] = useState(false);

  const checkboxChangeHandler = useCallback(e => {
    setChecked(e.detail.checked);
  }, []);

  useLayoutEffect(() => {
    checkboxRef.current.addEventListener('change', checkboxChangeHandler);

    return () => {
      checkboxRef.current.removeEventListener('change', checkboxChangeHandler);
    };
  }, [checkboxChangeHandler]);

  return <lp-checkbox {...props} ref={checkboxRef} checked={checked} />;
};

export default Checkbox
```

## Indeterminate

<Canvas withSource={SourceState.OPEN}>
  <Story
    name="Indeterminate"
    args={{ label: 'Indeterminate', indeterminate: true }}
    parameters={{
      controls: { disable: true },
      actions: { disable: true },
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>
