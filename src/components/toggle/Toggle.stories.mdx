import { Meta, Story, Canvas, ArgsTable, SourceState } from '@storybook/addon-docs';

import Controlled from './Controlled';
import Toggle from './Toggle';
import './';

<Meta
  title="Components/Inputs/Toggle"
  component={Toggle}
  args={{
    theme: 'dark',
    label: 'Toggle',
    labelPosition: 'right',
    a11y: false,
    checked: undefined,
    disabled: false,
    readOnly: false,
  }}
  argTypes={{
    theme: {
      control: { type: 'inline-radio' },
    },
    label: {},
    labelPosition: {
      control: { type: 'inline-radio' },
    },
    a11y: {},
    checked: {
      control: { type: 'boolean' },
    },
  }}
  parameters={{
    actions: {
      handles: ['change'],
    },
  }}
/>

# Toggle

<ArgsTable of={Toggle} />

**Note:** Those attributes extend [HTMLInputElement](https://www.w3schools.com/tags/tag_input.asp) attributes

## Basic

export const Template = ({
  theme,
  label,
  labelPosition,
  a11y,
  checked,
  disabled,
  readOnly,
}) => (
  <lp-toggle
    theme={theme === 'dark' ? undefined : theme}
    label={label}
    labelPosition={labelPosition === 'right' ? undefined : labelPosition}
    a11y={a11y === false ? undefined : a11y}
    checked={checked}
    disabled={disabled === false ? undefined : disabled}
    readOnly={readOnly === false ? undefined : readOnly}
  />
);

<Canvas>
  <Story name="Basic">
    {Template.bind({})}
  </Story>
</Canvas>

## Controlled

<Canvas withSource={SourceState.NONE}>
  <Story
    name="Controlled"
    args={{ label: 'Checked', checked: true }}
    parameters={{
      controls: { disable: true },
      actions: { disable: true },
    }}
  >
    {Controlled.bind({})}
  </Story>
</Canvas>

```jsx
import React, { useCallback, useLayoutEffect, useRef, useState } from 'react';

import 'liveperson-design-system/components/toggle';

const Toggle = ({ ...props }) => {
  const toggleRef = useRef(null);

  const [checked, setChecked] = useState(false);

  const toggleChangeHandler = useCallback(e => {
    setChecked(e.detail.checked);
  }, []);

  useLayoutEffect(() => {
    toggleRef.current.addEventListener('change', toggleChangeHandler);

    return () => {
      toggleRef.current.removeEventListener('change', toggleChangeHandler);
    };
  }, [toggleChangeHandler]);

  return <lp-toggle {...props} ref={toggleRef} checked={checked} />;
};

export default Toggle
```
