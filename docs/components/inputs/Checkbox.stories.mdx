import { useCallback, useLayoutEffect, useRef, useState } from 'react';
import { Meta, ArgsTable, SourceState } from '@storybook/addon-docs';

import Checkbox from '@liveperson-design-system/components/src/components/checkbox/Checkbox';
import '@liveperson-design-system/components/build/checkbox';

import Preview from '../../ui/Preview';

<Meta title="Components/Inputs/Checkbox" component={Checkbox} />

# Checkbox

```jsx
import '@liveperson-design-system/components/checkbox';
```

<ArgsTable of={Checkbox} />

**Note:** Those attributes extend [HTMLInputElement](https://www.w3schools.com/tags/tag_input.asp) attributes

## Basic

<Preview>
  <lp-checkbox theme="light" label="Checkbox" />
</Preview>

<Preview dark>
  <lp-checkbox label="Checkbox" />
</Preview>

## Label positions

<Preview>
  {['left', 'right'].map(position => (
    <lp-checkbox key={position} theme="light" labelPosition={position} label={`Label ${position}`} />
  ))}
</Preview>

## With error

<Preview>
  <lp-checkbox theme="light" label="Checkbox" error />
</Preview>

<Preview dark>
  <lp-checkbox label="Checkbox" error />
</Preview>

## Controlled

export const ControlledCheckbox = () => {
  const checkboxRef = useRef(null);
  const [checked, setChecked] = useState(false);
  const checkboxChangeHandler = useCallback(e => {
    setChecked(e.detail.checked);
  }, []);
  useLayoutEffect(() => {
    if (checkboxRef.current) {
      checkboxRef.current.addEventListener('change', checkboxChangeHandler);
    }
  }, [checkboxChangeHandler]);
  return <lp-checkbox ref={checkboxRef} theme="light" checked={checked} label={checked ? 'Checked' : 'Unchecked'} />;
};

<Preview withSource={SourceState.NONE}>
  <ControlledCheckbox />
</Preview>

```jsx
import React, { useCallback, useLayoutEffect, useRef, useState } from 'react';

import '@liveperson-design-system/components/checkbox';

const Checkbox = ({ ...props }) => {
  const checkboxRef = useRef(null);

  const [checked, setChecked] = useState(false);

  const checkboxChangeHandler = useCallback(e => {
    setChecked(e.detail.checked);
  }, []);

  useLayoutEffect(() => {
    checkboxRef.current.addEventListener('change', checkboxChangeHandler);

    return () => {
      checkboxRef.current.removeEventListener('change', checkboxChangeHandler);
    };
  }, [checkboxChangeHandler]);

  return <lp-checkbox {...props} ref={checkboxRef} checked={checked} />;
};

export default Checkbox
```

## Indeterminate

<Preview>
  <lp-checkbox theme="light" label="Checkbox" checked indeterminate />
</Preview>
